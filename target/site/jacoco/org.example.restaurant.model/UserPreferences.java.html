<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>UserPreferences.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">final</a> &gt; <a href="index.source.html" class="el_package">org.example.restaurant.model</a> &gt; <span class="el_source">UserPreferences.java</span></div><h1>UserPreferences.java</h1><pre class="source lang-java linenums">package org.example.restaurant.model;

import java.util.HashSet;
import java.util.Set;

/**
 * Represents user preferences for restaurant recommendations.
 */
public class UserPreferences {
    private Set&lt;CuisineType&gt; favoriteCuisines;
    private Set&lt;CuisineType&gt; dislikedCuisines;
    private int maxPriceLevel; // 1-4
    private double minAcceptableRating;
    private boolean preferVegetarian;
    private boolean preferVegan;
    private boolean preferGlutenFree;
    private boolean requiresParking;
    private boolean preferDelivery;
    private boolean preferTakeout;
    private double maxDistanceKm;
    private Location userLocation;

<span class="fc" id="L23">    public UserPreferences() {</span>
<span class="fc" id="L24">        this.favoriteCuisines = new HashSet&lt;&gt;();</span>
<span class="fc" id="L25">        this.dislikedCuisines = new HashSet&lt;&gt;();</span>
<span class="fc" id="L26">        this.maxPriceLevel = 4;</span>
<span class="fc" id="L27">        this.minAcceptableRating = 0.0;</span>
<span class="fc" id="L28">        this.maxDistanceKm = 10.0;</span>
<span class="fc" id="L29">    }</span>

    public Set&lt;CuisineType&gt; getFavoriteCuisines() {
<span class="fc" id="L32">        return favoriteCuisines;</span>
    }

    public void setFavoriteCuisines(Set&lt;CuisineType&gt; favoriteCuisines) {
<span class="fc" id="L36">        this.favoriteCuisines = favoriteCuisines;</span>
        // Mutual exclusion: Remove these from disliked
<span class="pc bpc" id="L38" title="2 of 4 branches missed.">        if (this.dislikedCuisines != null &amp;&amp; favoriteCuisines != null) {</span>
<span class="fc" id="L39">            this.dislikedCuisines.removeAll(favoriteCuisines);</span>
        }
<span class="fc" id="L41">    }</span>

    public void addFavoriteCuisine(CuisineType type) {
<span class="fc bfc" id="L44" title="All 2 branches covered.">        if (type != null) {</span>
<span class="fc" id="L45">            favoriteCuisines.add(type);</span>
<span class="fc" id="L46">            dislikedCuisines.remove(type);</span>
        }
<span class="fc" id="L48">    }</span>

    public Set&lt;CuisineType&gt; getDislikedCuisines() {
<span class="fc" id="L51">        return dislikedCuisines;</span>
    }

    public void setDislikedCuisines(Set&lt;CuisineType&gt; dislikedCuisines) {
<span class="fc" id="L55">        this.dislikedCuisines = dislikedCuisines;</span>
        // Mutual exclusion: Remove these from favorites
<span class="pc bpc" id="L57" title="2 of 4 branches missed.">        if (this.favoriteCuisines != null &amp;&amp; dislikedCuisines != null) {</span>
<span class="fc" id="L58">            this.favoriteCuisines.removeAll(dislikedCuisines);</span>
        }
<span class="fc" id="L60">    }</span>

    public void addDislikedCuisine(CuisineType type) {
<span class="fc bfc" id="L63" title="All 2 branches covered.">        if (type != null) {</span>
<span class="fc" id="L64">            dislikedCuisines.add(type);</span>
<span class="fc" id="L65">            favoriteCuisines.remove(type);</span>
        }
<span class="fc" id="L67">    }</span>

    public int getMaxPriceLevel() {
<span class="fc" id="L70">        return maxPriceLevel;</span>
    }

    public void setMaxPriceLevel(int maxPriceLevel) {
<span class="fc" id="L74">        this.maxPriceLevel = Math.max(1, Math.min(4, maxPriceLevel));</span>
<span class="fc" id="L75">    }</span>

    public double getMinAcceptableRating() {
<span class="fc" id="L78">        return minAcceptableRating;</span>
    }

    public void setMinAcceptableRating(double minAcceptableRating) {
<span class="fc" id="L82">        this.minAcceptableRating = Math.max(0, Math.min(5, minAcceptableRating));</span>
<span class="fc" id="L83">    }</span>

    public boolean isPreferVegetarian() {
<span class="fc" id="L86">        return preferVegetarian;</span>
    }

    public void setPreferVegetarian(boolean preferVegetarian) {
<span class="fc" id="L90">        this.preferVegetarian = preferVegetarian;</span>
<span class="fc" id="L91">    }</span>

    public boolean isPreferVegan() {
<span class="fc" id="L94">        return preferVegan;</span>
    }

    public void setPreferVegan(boolean preferVegan) {
<span class="fc" id="L98">        this.preferVegan = preferVegan;</span>
<span class="fc" id="L99">    }</span>

    public boolean isPreferGlutenFree() {
<span class="fc" id="L102">        return preferGlutenFree;</span>
    }

    public void setPreferGlutenFree(boolean preferGlutenFree) {
<span class="fc" id="L106">        this.preferGlutenFree = preferGlutenFree;</span>
<span class="fc" id="L107">    }</span>

    public boolean isRequiresParking() {
<span class="fc" id="L110">        return requiresParking;</span>
    }

    public void setRequiresParking(boolean requiresParking) {
<span class="fc" id="L114">        this.requiresParking = requiresParking;</span>
<span class="fc" id="L115">    }</span>

    public boolean isPreferDelivery() {
<span class="fc" id="L118">        return preferDelivery;</span>
    }

    public void setPreferDelivery(boolean preferDelivery) {
<span class="fc" id="L122">        this.preferDelivery = preferDelivery;</span>
<span class="fc" id="L123">    }</span>

    public boolean isPreferTakeout() {
<span class="fc" id="L126">        return preferTakeout;</span>
    }

    public void setPreferTakeout(boolean preferTakeout) {
<span class="fc" id="L130">        this.preferTakeout = preferTakeout;</span>
<span class="fc" id="L131">    }</span>

    public double getMaxDistanceKm() {
<span class="fc" id="L134">        return maxDistanceKm;</span>
    }

    public void setMaxDistanceKm(double maxDistanceKm) {
<span class="fc" id="L138">        this.maxDistanceKm = maxDistanceKm;</span>
<span class="fc" id="L139">    }</span>

    public Location getUserLocation() {
<span class="fc" id="L142">        return userLocation;</span>
    }

    public void setUserLocation(Location userLocation) {
<span class="fc" id="L146">        this.userLocation = userLocation;</span>
<span class="fc" id="L147">    }</span>

    public boolean likesCuisine(CuisineType type) {
<span class="fc bfc" id="L150" title="All 2 branches covered.">        if (type == null) {</span>
<span class="fc" id="L151">            return false;</span>
        }
<span class="fc" id="L153">        return favoriteCuisines.contains(type);</span>
    }

    public boolean dislikesCuisine(CuisineType type) {
<span class="fc bfc" id="L157" title="All 2 branches covered.">        if (type == null) {</span>
<span class="fc" id="L158">            return false;</span>
        }
<span class="fc" id="L160">        return dislikedCuisines.contains(type);</span>
    }

    public double calculatePreferenceScore(Restaurant restaurant) {
<span class="fc bfc" id="L164" title="All 2 branches covered.">        if (restaurant == null) {</span>
<span class="fc" id="L165">            return 0.0;</span>
        }

<span class="fc" id="L168">        double score = 50.0; // Base score</span>

        // Cuisine preference
<span class="fc bfc" id="L171" title="All 2 branches covered.">        if (likesCuisine(restaurant.getCuisineType())) {</span>
<span class="fc" id="L172">            score += 20;</span>
<span class="fc bfc" id="L173" title="All 2 branches covered.">        } else if (dislikesCuisine(restaurant.getCuisineType())) {</span>
<span class="fc" id="L174">            score -= 30;</span>
        }

        // Check additional cuisine types
<span class="fc bfc" id="L178" title="All 2 branches covered.">        for (CuisineType type : restaurant.getAdditionalCuisineTypes()) {</span>
<span class="fc bfc" id="L179" title="All 2 branches covered.">            if (likesCuisine(type)) {</span>
<span class="fc" id="L180">                score += 10;</span>
<span class="fc bfc" id="L181" title="All 2 branches covered.">            } else if (dislikesCuisine(type)) {</span>
<span class="fc" id="L182">                score -= 15;</span>
            }
<span class="fc" id="L184">        }</span>

        // Price level
<span class="pc bpc" id="L187" title="1 of 4 branches missed.">        if (restaurant.getPriceLevel() &gt; 0 &amp;&amp; restaurant.getPriceLevel() &lt;= maxPriceLevel) {</span>
<span class="fc" id="L188">            score += 10;</span>
<span class="pc bpc" id="L189" title="1 of 2 branches missed.">        } else if (restaurant.getPriceLevel() &gt; maxPriceLevel) {</span>
<span class="fc" id="L190">            score -= 20;</span>
        }

        // Rating
<span class="fc" id="L194">        double rating = restaurant.calculateAverageRating();</span>
<span class="fc bfc" id="L195" title="All 2 branches covered.">        if (rating &gt;= minAcceptableRating) {</span>
<span class="fc" id="L196">            score += (rating / 5.0) * 15;</span>
        } else {
<span class="fc" id="L198">            score -= 25;</span>
        }

        // Features
<span class="fc bfc" id="L202" title="All 4 branches covered.">        if (requiresParking &amp;&amp; restaurant.isHasParking()) {</span>
<span class="fc" id="L203">            score += 10;</span>
<span class="pc bpc" id="L204" title="1 of 4 branches missed.">        } else if (requiresParking &amp;&amp; !restaurant.isHasParking()) {</span>
<span class="fc" id="L205">            score -= 20;</span>
        }

<span class="pc bpc" id="L208" title="1 of 4 branches missed.">        if (preferDelivery &amp;&amp; restaurant.isHasDelivery()) {</span>
<span class="fc" id="L209">            score += 5;</span>
        }

<span class="pc bpc" id="L212" title="1 of 4 branches missed.">        if (preferTakeout &amp;&amp; restaurant.isHasTakeout()) {</span>
<span class="fc" id="L213">            score += 5;</span>
        }

<span class="fc" id="L216">        return Math.max(0, Math.min(100, score));</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>