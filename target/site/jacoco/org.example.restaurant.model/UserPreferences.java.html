<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>UserPreferences.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">final</a> &gt; <a href="index.source.html" class="el_package">org.example.restaurant.model</a> &gt; <span class="el_source">UserPreferences.java</span></div><h1>UserPreferences.java</h1><pre class="source lang-java linenums">package org.example.restaurant.model;

import java.util.HashSet;
import java.util.Set;

/**
 * Represents user preferences for restaurant recommendations.
 */
public class UserPreferences {
    private Set&lt;CuisineType&gt; favoriteCuisines;
    private Set&lt;CuisineType&gt; dislikedCuisines;
    private int maxPriceLevel; // 1-4
    private double minAcceptableRating;
    private boolean preferVegetarian;
    private boolean preferVegan;
    private boolean preferGlutenFree;
    private boolean requiresParking;
    private boolean preferDelivery;
    private boolean preferTakeout;
    private double maxDistanceKm;
    private Location userLocation;

<span class="fc" id="L23">    public UserPreferences() {</span>
<span class="fc" id="L24">        this.favoriteCuisines = new HashSet&lt;&gt;();</span>
<span class="fc" id="L25">        this.dislikedCuisines = new HashSet&lt;&gt;();</span>
<span class="fc" id="L26">        this.maxPriceLevel = 4;</span>
<span class="fc" id="L27">        this.minAcceptableRating = 0.0;</span>
<span class="fc" id="L28">        this.maxDistanceKm = 10.0;</span>
<span class="fc" id="L29">    }</span>

    public Set&lt;CuisineType&gt; getFavoriteCuisines() {
<span class="nc" id="L32">        return favoriteCuisines;</span>
    }

    public void setFavoriteCuisines(Set&lt;CuisineType&gt; favoriteCuisines) {
<span class="nc" id="L36">        this.favoriteCuisines = favoriteCuisines;</span>
<span class="nc" id="L37">    }</span>

    public void addFavoriteCuisine(CuisineType type) {
<span class="pc bpc" id="L40" title="1 of 2 branches missed.">        if (type != null) {</span>
<span class="fc" id="L41">            favoriteCuisines.add(type);</span>
<span class="fc" id="L42">            dislikedCuisines.remove(type);</span>
        }
<span class="fc" id="L44">    }</span>

    public Set&lt;CuisineType&gt; getDislikedCuisines() {
<span class="nc" id="L47">        return dislikedCuisines;</span>
    }

    public void setDislikedCuisines(Set&lt;CuisineType&gt; dislikedCuisines) {
<span class="nc" id="L51">        this.dislikedCuisines = dislikedCuisines;</span>
<span class="nc" id="L52">    }</span>

    public void addDislikedCuisine(CuisineType type) {
<span class="pc bpc" id="L55" title="1 of 2 branches missed.">        if (type != null) {</span>
<span class="fc" id="L56">            dislikedCuisines.add(type);</span>
<span class="fc" id="L57">            favoriteCuisines.remove(type);</span>
        }
<span class="fc" id="L59">    }</span>

    public int getMaxPriceLevel() {
<span class="fc" id="L62">        return maxPriceLevel;</span>
    }

    public void setMaxPriceLevel(int maxPriceLevel) {
<span class="fc" id="L66">        this.maxPriceLevel = Math.max(1, Math.min(4, maxPriceLevel));</span>
<span class="fc" id="L67">    }</span>

    public double getMinAcceptableRating() {
<span class="fc" id="L70">        return minAcceptableRating;</span>
    }

    public void setMinAcceptableRating(double minAcceptableRating) {
<span class="fc" id="L74">        this.minAcceptableRating = Math.max(0, Math.min(5, minAcceptableRating));</span>
<span class="fc" id="L75">    }</span>

    public boolean isPreferVegetarian() {
<span class="nc" id="L78">        return preferVegetarian;</span>
    }

    public void setPreferVegetarian(boolean preferVegetarian) {
<span class="nc" id="L82">        this.preferVegetarian = preferVegetarian;</span>
<span class="nc" id="L83">    }</span>

    public boolean isPreferVegan() {
<span class="nc" id="L86">        return preferVegan;</span>
    }

    public void setPreferVegan(boolean preferVegan) {
<span class="nc" id="L90">        this.preferVegan = preferVegan;</span>
<span class="nc" id="L91">    }</span>

    public boolean isPreferGlutenFree() {
<span class="nc" id="L94">        return preferGlutenFree;</span>
    }

    public void setPreferGlutenFree(boolean preferGlutenFree) {
<span class="nc" id="L98">        this.preferGlutenFree = preferGlutenFree;</span>
<span class="nc" id="L99">    }</span>

    public boolean isRequiresParking() {
<span class="fc" id="L102">        return requiresParking;</span>
    }

    public void setRequiresParking(boolean requiresParking) {
<span class="nc" id="L106">        this.requiresParking = requiresParking;</span>
<span class="nc" id="L107">    }</span>

    public boolean isPreferDelivery() {
<span class="fc" id="L110">        return preferDelivery;</span>
    }

    public void setPreferDelivery(boolean preferDelivery) {
<span class="nc" id="L114">        this.preferDelivery = preferDelivery;</span>
<span class="nc" id="L115">    }</span>

    public boolean isPreferTakeout() {
<span class="fc" id="L118">        return preferTakeout;</span>
    }

    public void setPreferTakeout(boolean preferTakeout) {
<span class="nc" id="L122">        this.preferTakeout = preferTakeout;</span>
<span class="nc" id="L123">    }</span>

    public double getMaxDistanceKm() {
<span class="nc" id="L126">        return maxDistanceKm;</span>
    }

    public void setMaxDistanceKm(double maxDistanceKm) {
<span class="nc" id="L130">        this.maxDistanceKm = maxDistanceKm;</span>
<span class="nc" id="L131">    }</span>

    public Location getUserLocation() {
<span class="fc" id="L134">        return userLocation;</span>
    }

    public void setUserLocation(Location userLocation) {
<span class="nc" id="L138">        this.userLocation = userLocation;</span>
<span class="nc" id="L139">    }</span>

    public boolean likesCuisine(CuisineType type) {
<span class="pc bpc" id="L142" title="1 of 2 branches missed.">        if (type == null) {</span>
<span class="nc" id="L143">            return false;</span>
        }
<span class="fc" id="L145">        return favoriteCuisines.contains(type);</span>
    }

    public boolean dislikesCuisine(CuisineType type) {
<span class="pc bpc" id="L149" title="1 of 2 branches missed.">        if (type == null) {</span>
<span class="nc" id="L150">            return false;</span>
        }
<span class="fc" id="L152">        return dislikedCuisines.contains(type);</span>
    }

    public double calculatePreferenceScore(Restaurant restaurant) {
<span class="pc bpc" id="L156" title="1 of 2 branches missed.">        if (restaurant == null) {</span>
<span class="nc" id="L157">            return 0.0;</span>
        }

<span class="fc" id="L160">        double score = 50.0; // Base score</span>

        // Cuisine preference
<span class="pc bpc" id="L163" title="1 of 2 branches missed.">        if (likesCuisine(restaurant.getCuisineType())) {</span>
<span class="fc" id="L164">            score += 20;</span>
<span class="nc bnc" id="L165" title="All 2 branches missed.">        } else if (dislikesCuisine(restaurant.getCuisineType())) {</span>
<span class="nc" id="L166">            score -= 30;</span>
        }

        // Check additional cuisine types
<span class="pc bpc" id="L170" title="1 of 2 branches missed.">        for (CuisineType type : restaurant.getAdditionalCuisineTypes()) {</span>
<span class="nc bnc" id="L171" title="All 2 branches missed.">            if (likesCuisine(type)) {</span>
<span class="nc" id="L172">                score += 10;</span>
<span class="nc bnc" id="L173" title="All 2 branches missed.">            } else if (dislikesCuisine(type)) {</span>
<span class="nc" id="L174">                score -= 15;</span>
            }
<span class="nc" id="L176">        }</span>

        // Price level
<span class="pc bpc" id="L179" title="2 of 4 branches missed.">        if (restaurant.getPriceLevel() &gt; 0 &amp;&amp; restaurant.getPriceLevel() &lt;= maxPriceLevel) {</span>
<span class="fc" id="L180">            score += 10;</span>
<span class="nc bnc" id="L181" title="All 2 branches missed.">        } else if (restaurant.getPriceLevel() &gt; maxPriceLevel) {</span>
<span class="nc" id="L182">            score -= 20;</span>
        }

        // Rating
<span class="fc" id="L186">        double rating = restaurant.calculateAverageRating();</span>
<span class="pc bpc" id="L187" title="1 of 2 branches missed.">        if (rating &gt;= minAcceptableRating) {</span>
<span class="fc" id="L188">            score += (rating / 5.0) * 15;</span>
        } else {
<span class="nc" id="L190">            score -= 25;</span>
        }

        // Features
<span class="pc bpc" id="L194" title="3 of 4 branches missed.">        if (requiresParking &amp;&amp; restaurant.isHasParking()) {</span>
<span class="nc" id="L195">            score += 10;</span>
<span class="pc bpc" id="L196" title="3 of 4 branches missed.">        } else if (requiresParking &amp;&amp; !restaurant.isHasParking()) {</span>
<span class="nc" id="L197">            score -= 20;</span>
        }

<span class="pc bpc" id="L200" title="3 of 4 branches missed.">        if (preferDelivery &amp;&amp; restaurant.isHasDelivery()) {</span>
<span class="nc" id="L201">            score += 5;</span>
        }

<span class="pc bpc" id="L204" title="3 of 4 branches missed.">        if (preferTakeout &amp;&amp; restaurant.isHasTakeout()) {</span>
<span class="nc" id="L205">            score += 5;</span>
        }

<span class="fc" id="L208">        return Math.max(0, Math.min(100, score));</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>